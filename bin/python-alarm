#!/usr/bin/env python3

import datetime
import time
from mpd import MPDClient

print("Please enter a time in 24H format like HH:MM:SS.")
userTime = input()

url = 'http://bbcmedia.ic.llnwd.net/stream/bbcmedia_radio1_mf_p'

try:
    while userTime != datetime.datetime.now().strftime("%H:%M:%S"):
        pass
    else:
        print("Alarm!")
        time_end = time.time() + 60 * 5
        client = MPDClient()
        client.connect('localhost', 6600)
        client.add(url)
        while time.time() < time_end:
            client.play(1)
        else:
            client.stop()
            client.close()
            client.disconnect()
            exit(0)
except KeyboardInterrupt:
    client.stop()
    client.close()
    client.disconnect()
    print("Cancelled by user.")
    exit(1)
